# 3 Python经典问题

## 1 基础

### 1.1 变量与赋值

* 变量: 是一个系统表的元素, 拥有指向对象的连接空间
* 对象: 被分配的一块内存, 存储其所代表的值
* 引用: 是自动形成的从变量到对象的指针
* 类型: 属于对象, 而非变量
* 不可变对象: 一旦创建就不可修改的对象, 包括字符串、元组、数值类型
  + 不可变对象所指向的内存中的值不能变. 改变时其实是复制一份再改变, 变量指向新的地址.
* 可变对象: 可以修改的对象, 包括列表、字典、集合
  + 原地改变

赋值操作:

<div style="text-align: center; width: 70%; margin: auto; ">
<img width=100% src="img/2021_07_12_17_14_48.png">
</div>

### 1.2 赋值, 深拷贝, 浅拷贝

#### 1. 赋值: 只是复制了新对象的引用, 不会开辟新的内存空间.

并不会产生一个独立的对象单独存在, 只是将原有的数据块打上一个新标签, 所以当其中一个标签被改变的时候, 数据块就会发生变化, 另一个标签也会随之改变.

#### 2. 浅拷贝: 创建新对象, 其内容是原对象的引用.

浅拷贝有三种形式: 切片操作, 工厂函数, copy模块中的copy函数.

操作: 只拷贝对象最外边的一层, 而内部还是引用.
1. 当浅拷贝的值是不可变对象（字符串、元组、数值类型）时和“赋值”的情况一样，对象的id值（id()函数用于获取对象的内存地址）与浅复制原来的值相同。
2. 当浅复制的值是可变对象(列表、字典、集合)时会产生一个"不是那么独立的对象"存在. 有两种情况:
   - 复制的对象中无复杂子对象, 原来值的改变并不会影响浅复制的值, 同时浅复制的值改变也并不会影响原来的值. 原来值的id值与浅复制原来的值不同.
   - 复制的对象中有复杂子对象(例如列表中的一个子元素是一个列表), 如果不改变其中复杂子对象, 浅复制的值改变并不会影响原来的值. 但是改变原来的值中的复杂子对象的值会影响浅复制的值.

#### 3. 深拷贝: 深拷贝拷贝了对象的所有元素, 包括多层嵌套的元素. 深拷贝出来的对象是一个全新的对象, 不再与原来的对象有任何关联.

所以改变原有被复制对象不会对已经复制出来的新对象产生影响.

只有一种形式, copy模块中的deepcopy函数

#### 4 举例

1. 不可变类型，不管是深拷贝还是浅拷贝，地址值和拷贝后的值都是一样的。
2. 对于可变对象深浅拷贝
   - 赋值: 值相等, 地址相等
   - copy浅拷贝: 值相等, 地址不相等
   - deepcopy深拷贝: 值相等, 地址不相等
3. 对于可变对象深浅拷贝(外层改变元素)
   - 外层添加元素时, 浅拷贝不会随原列表变化而变化; 内层添加元素时, 浅拷贝才会变化.
   - 无论原列表如何变化, 深拷贝都保持不变.
   - 赋值对象随着原列表一起变化.
